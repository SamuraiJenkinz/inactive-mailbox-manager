---
phase: 05-terminal-ui
plan: 01
type: execute
---

<objective>
Implement main application screen with mailbox list view using Textual framework.

Purpose: Create the primary terminal interface for viewing and navigating inactive mailboxes.
Output: Working Textual app with main screen, mailbox data table, and keyboard navigation.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/core/mailbox_service.py
@src/core/filter_service.py

**From PROJECT.md:**
- Terminal UI using Textual framework
- Brutalist dark theme aesthetic
- Full keyboard navigation
- DataTable for mailbox listing
- Status bar with connection info

**Key Textual components:**
- App: Main application class
- Screen: Individual screens/views
- DataTable: For mailbox listing
- Input: For search/filter
- Footer: Keyboard shortcuts
- Header: App title and status

**Brutalist theme colors:**
- Background: #1a1a1a (near black)
- Surface: #2d2d2d (dark gray)
- Primary: #00ff00 (terminal green)
- Accent: #ff6600 (orange)
- Text: #e0e0e0 (light gray)
- Error: #ff3333 (red)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Textual app structure</name>
  <files>src/ui/__init__.py, src/ui/app.py</files>
  <action>
    Create base Textual application:

    1. Create src/ui/ directory with __init__.py

    2. Create InactiveMailboxApp class in app.py:
       - Inherit from textual.app.App
       - Set TITLE, SUB_TITLE
       - Configure CSS_PATH for styling
       - Set BINDINGS for keyboard shortcuts

    3. Define key bindings:
       - q: Quit application
       - /: Focus search
       - r: Refresh data
       - d: Show details
       - c: Connect/disconnect
       - ?: Show help

    4. Create compose() method:
       - Header with app title
       - Main content area
       - Footer with key bindings

    5. Create action methods:
       - action_quit()
       - action_refresh()
       - action_toggle_help()
  </action>
  <verify>python -c "from src.ui.app import InactiveMailboxApp; print('Textual app imported')"</verify>
  <done>Base Textual app structure created</done>
</task>

<task type="auto">
  <name>Task 2: Create brutalist theme CSS</name>
  <files>src/ui/styles/theme.tcss</files>
  <action>
    Create Textual CSS stylesheet:

    1. Create src/ui/styles/ directory

    2. Define color variables:
       ```tcss
       $background: #1a1a1a;
       $surface: #2d2d2d;
       $primary: #00ff00;
       $accent: #ff6600;
       $text: #e0e0e0;
       $text-muted: #888888;
       $error: #ff3333;
       $warning: #ffaa00;
       $success: #00ff00;
       ```

    3. Style Screen:
       - Dark background
       - Padding and layout

    4. Style Header:
       - Background surface color
       - Bold title

    5. Style Footer:
       - Key binding display
       - Muted text color

    6. Style DataTable:
       - Alternating row colors
       - Highlighted selection
       - Green cursor row

    7. Style Input:
       - Border with primary color on focus
       - Placeholder text styling

    8. Style buttons and containers
  </action>
  <verify>Test: ls src/ui/styles/theme.tcss</verify>
  <done>Brutalist theme CSS created</done>
</task>

<task type="auto">
  <name>Task 3: Create mailbox list screen</name>
  <files>src/ui/screens/main_screen.py</files>
  <action>
    Create main screen with mailbox DataTable:

    1. Create src/ui/screens/ directory with __init__.py

    2. Create MainScreen class:
       - Inherit from textual.screen.Screen
       - BINDINGS for screen-specific keys

    3. compose() method:
       - Search Input at top
       - DataTable for mailboxes
       - Status bar at bottom

    4. DataTable columns:
       - Display Name
       - Primary SMTP
       - Size
       - Items
       - Hold Status
       - Disconnected Date

    5. Methods:
       - on_mount(): Load initial data
       - load_mailboxes(): Fetch and display
       - on_input_changed(): Filter as you type
       - on_data_table_row_selected(): Show details

    6. Status bar showing:
       - Total mailboxes
       - Filtered count
       - Connection status
  </action>
  <verify>python -c "from src.ui.screens.main_screen import MainScreen; print('MainScreen imported')"</verify>
  <done>Mailbox list screen with DataTable working</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Textual app launches without errors
- [ ] Main screen displays mailbox DataTable
- [ ] Keyboard navigation works
- [ ] Search/filter updates table
- [ ] Theme applies correctly
- [ ] Status bar shows counts
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- App launches and displays data
- Theme is consistent
- Keyboard shortcuts work
</success_criteria>

<output>
After completion, create `.planning/phases/05-terminal-ui/05-01-SUMMARY.md`
</output>
