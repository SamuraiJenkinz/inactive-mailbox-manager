---
phase: 05-terminal-ui
plan: 03
type: execute
---

<objective>
Implement wizard screens for recovery, restore, and bulk operations.

Purpose: Provide guided step-by-step interfaces for complex operations.
Output: Working wizard screens for recovery, restore, bulk operations, and connection.
</objective>

<context>
@.planning/phases/05-terminal-ui/05-01-SUMMARY.md
@.planning/phases/05-terminal-ui/05-02-SUMMARY.md
@src/core/recovery_wizard.py
@src/core/bulk_operations.py

**Wizard requirements:**
1. Recovery Wizard: Step-by-step mailbox recovery
2. Restore Wizard: Restore to existing mailbox
3. Bulk Operations: CSV import and batch execution
4. Connection Wizard: Exchange Online connection

**Textual wizard components:**
- ProgressBar: For operation progress
- Button: For navigation
- Input: For user data entry
- Select: For dropdown choices
- RadioSet: For options
- LoadingIndicator: For async operations
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create recovery wizard screen</name>
  <files>src/ui/screens/recovery_wizard_screen.py</files>
  <action>
    Create recovery wizard interface:

    1. Create RecoveryWizardScreen class:
       - Multi-step wizard flow
       - Progress indicator

    2. Step 1 - Select Mailbox:
       - Show selected mailbox info
       - Confirm selection

    3. Step 2 - Validation:
       - Run pre-flight checks
       - Display validation results
       - Show blockers/warnings

    4. Step 3 - Enter Details:
       - Target UPN input
       - Target SMTP input
       - Display name
       - Optional: department, company

    5. Step 4 - Confirm:
       - Summary of operation
       - Estimated time
       - Confirm/Cancel buttons

    6. Step 5 - Execute:
       - Progress indicator
       - Status updates
       - Result display

    7. Navigation:
       - Next/Previous buttons
       - Cancel to exit
       - Escape to go back
  </action>
  <verify>python -c "from src.ui.screens.recovery_wizard_screen import RecoveryWizardScreen; print('RecoveryWizardScreen imported')"</verify>
  <done>Recovery wizard with step-by-step flow</done>
</task>

<task type="auto">
  <name>Task 2: Create bulk operations screen</name>
  <files>src/ui/screens/bulk_screen.py</files>
  <action>
    Create bulk operations interface:

    1. Create BulkOperationsScreen class:
       - CSV import
       - Operation selection
       - Batch execution

    2. Operation type selection:
       - Bulk Recovery
       - Bulk Restore
       - Bulk Validation
       - Bulk Export

    3. CSV import section:
       - File path input
       - Validation results
       - Preview of items

    4. Execution section:
       - Progress bar
       - Current item display
       - Success/failure counts

    5. Results section:
       - Summary statistics
       - Failed items list
       - Export results option

    6. Controls:
       - Start/Pause/Cancel
       - Retry failed
       - Export results
  </action>
  <verify>python -c "from src.ui.screens.bulk_screen import BulkOperationsScreen; print('BulkOperationsScreen imported')"</verify>
  <done>Bulk operations with progress tracking</done>
</task>

<task type="auto">
  <name>Task 3: Create connection and help screens</name>
  <files>src/ui/screens/connection_screen.py, src/ui/screens/help_screen.py</files>
  <action>
    Create auxiliary screens:

    1. ConnectionScreen class:
       - Connection status display
       - Connect button
       - Tenant info display
       - Disconnect option
       - Connection history

    2. Connection flow:
       - Show current status
       - Trigger authentication
       - Display progress
       - Show result

    3. HelpScreen class:
       - Keyboard shortcuts reference
       - Feature overview
       - About information

    4. Help content:
       - Navigation keys
       - Action shortcuts
       - Screen descriptions
       - Contact/support info

    5. Modal dialogs:
       - Confirmation dialog
       - Error dialog
       - Success notification
  </action>
  <verify>python -c "from src.ui.screens.connection_screen import ConnectionScreen; print('ConnectionScreen imported')"</verify>
  <done>Connection and help screens complete</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Recovery wizard completes all steps
- [ ] Bulk operations shows progress
- [ ] Connection screen works
- [ ] Help screen displays shortcuts
- [ ] All wizards handle errors gracefully
- [ ] Progress indicators update correctly
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Wizards guide users through operations
- Progress is visible during operations
- Errors are handled gracefully
</success_criteria>

<output>
After completion, create `.planning/phases/05-terminal-ui/05-03-SUMMARY.md`

**Phase 5 Complete Checklist:**
- [ ] Main screen with mailbox list
- [ ] Detail view for mailboxes
- [ ] Holds analysis view
- [ ] Cost dashboard
- [ ] Recovery wizard
- [ ] Bulk operations screen
- [ ] Connection management
- [ ] Help screen
- [ ] Consistent brutalist theme
</output>
